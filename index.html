<script>
    var canvas = document.querySelector("#unity-canvas");
    var myGameInstance = null; // DÃ©finition de la variable globale

    var config = {
        dataUrl: "Build/Build.data",
        frameworkUrl: "Build/Build.framework.js",
        codeUrl: "Build/Build.wasm",
        memoryUrl: "Build/",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "Snake",
        productVersion: "1.0",
        backgroundColor: "#314D79",
        useWebGL2: true,
    };

    function progressHandler(progress) {
        var percent = progress * 100 + '%';
        canvas.style.background = 'linear-gradient(to right, white, white ' + percent + ', transparent ' + percent + ', transparent) no-repeat center';
        canvas.style.backgroundSize = '100% 1rem';
    }

    let resizeTimeout;
    function onResize() {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(function() {
            var container = canvas.parentElement;
            var w = window.innerWidth;
            var h = window.innerHeight;
            container.style.width = w + "px";
            container.style.height = h + "px";
            canvas.style.width = "100%";
            canvas.style.height = "100%";

            if (myGameInstance && myGameInstance.Module) {
                window.requestAnimationFrame(function() {
                    myGameInstance.Module.canvas.width = w;
                    myGameInstance.Module.canvas.height = h;
                    myGameInstance.SendMessage('GameManager', 'OnScreenResize', w + "," + h);
                });
            }
        }, 15);
    }

    // âœ… Assigne l'instance de Unity Ã  `myGameInstance`
    createUnityInstance(canvas, config, progressHandler).then(function (instance) {
        myGameInstance = instance; // ðŸ”¥ Stocke l'instance ici !
        canvas = instance.Module.canvas;
        onResize();

        // Change la couleur de fond
        document.body.style.backgroundColor = "#314D79";
        canvas.style.backgroundColor = "#314D79";

        console.log("Unity chargÃ© !");
    }).catch(function (error) {
        console.error("Erreur de chargement Unity : ", error);
    });

    window.addEventListener('resize', onResize);
    onResize();
</script>
